node('master') {

stage 'buildInDevelopment'
openshiftBuild(namespace: 'jag-csb-edivorce-tools', buildConfig: 'edivorce-django', showBuildLogs: 'true')

stage 'deployInDevelopment'
openshiftDeploy(namespace: 'jag-csb-edivorce-dev', deploymentConfig: 'edivorce-django')
openshiftScale(namespace: 'jag-csb-edivorce-dev', deploymentConfig: 'edivorce-django',replicaCount: '1')

stage 'test'
sh 'curl -s  https://justice.gov.bc.ca/divorce-dev'

stage 'deployInTesting'
openshiftTag(namespace: 'jag-csb-edivorce-tools', sourceStream: 'edivorce-django',  sourceTag: 'latest', destinationNamespace: 'jag-csb-edivorce-tools',  destinationStream: 'edivorce-django', destinationTag: 'deploy-to-test')
openshiftDeploy(namespace: 'jag-csb-edivorce-test', deploymentConfig: 'edivorce-django')
openshiftScale(namespace: 'jag-csb-edivorce-test', deploymentConfig: 'edivorce-django',replicaCount: '1')
}

